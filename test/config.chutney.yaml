# TS & SK config for chutney single-round, multi-DC, multi-SK integration test

tally_server:
    counters: 'counters.bins.yaml'
    noise: 'counters.noise.yaml'
    traffic_model: 'traffic.model.json'
    traffic_noise: 'traffic.noise.yaml'
    domain_files:
        - 'domain-top-1k.txt'
        - 'domain-tld.txt'
        - 'domain-cc.txt'
        - 'domain-google.txt'
        - 'domain-torproject.txt'
        - 'domain-local.txt'
    country_files:
        - 'country-all.txt'
        - 'country-known.txt'
        - 'country-top-10.txt'
        - 'country-unknown.txt'
        - 'country-no-geoip.txt'
    as_prefix_files:
        4: 'as-ipv4-test.ipasn'
        6: 'as-ipv6-test.ipasn'
    as_files:
        - 'as-rank.txt'
        - 'as-top-100.txt'
        - 'as-ipv4-extra.txt'
        - 'as-ipv6-extra.txt'
    allocation: 'counters.allocation.yaml'
    noise_weight:
        '*': 1.0
    listen_port: 20001
    # Template values, replaced by run_test.sh
    sk_threshold: PRIVCOUNT_SHARE_KEEPERS
    dc_threshold: DATA_COLLECTOR_COUNT
    collect_period: 60
    event_period: 15
    checkin_period: 15
    delay_period: 86400
    # Ignore some circuits, so we test this feature
    circuit_sample_rate: 0.5
    # set a cell limit, so we test this feature
    max_cell_events_per_circuit: 25
    key: 'keys/ts.pem'
    cert: 'keys/ts.cert'
    secret_handshake: 'keys/secret_handshake.yaml'

share_keeper:
    # Template values, replaced by run_test.sh
    key: 'keys/sk.SK_NUM.pem'
    tally_server_info:
        ip: '127.0.0.1'
        port: 20001
    delay_period: 86400
    secret_handshake: 'keys/secret_handshake.yaml'

data_collector:
    # Template values, replaced by run_test.sh
    name: 'dc-chutney-test-DC_SOURCE_PORT'
    event_source:
        # Template value, replaced by run_test.sh
        port: DC_SOURCE_PORT
    tally_server_info:
        ip: 127.0.0.1
        port: 20001
    share_keepers:
        # Template list value, replaced by run_test.sh
        - SK_LIST
    delay_period: 86400
    rotate_period: 5
    secret_handshake: 'keys/secret_handshake.yaml'
